
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.46">
    
    
      
        <title>Adding Kudos to the Application - Cycling Beats - Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.6f8fc17f.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="light-blue">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#adding-kudos-to-the-application" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Cycling Beats - Documentation" class="md-header__button md-logo" aria-label="Cycling Beats - Documentation" data-md-component="logo">
      
  <img src="../../assets/logo.jpg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Cycling Beats - Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Adding Kudos to the Application
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="light-blue"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="light-blue"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../conventions/" class="md-tabs__link">
        
  
    
  
  Conventions

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../install_guides/" class="md-tabs__link">
        
  
    
  
  Install Guides

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../" class="md-tabs__link">
        
  
    
  
  Tasks

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../tools/" class="md-tabs__link">
        
  
    
  
  Tools

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../dependencies/" class="md-tabs__link">
        
  
    
  
  Dependencies

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../beats_tools/" class="md-tabs__link">
        
  
    
  
  Beats-Tools

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../beats_docs/" class="md-tabs__link">
        
  
    
  
  Beats-Docs

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../misc/" class="md-tabs__link">
        
  
    
  
  Misc.

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../extras/" class="md-tabs__link">
        
  
    
  
  Extras

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Cycling Beats - Documentation" class="md-nav__button md-logo" aria-label="Cycling Beats - Documentation" data-md-component="logo">
      
  <img src="../../assets/logo.jpg" alt="logo">

    </a>
    Cycling Beats - Documentation
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../conventions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Conventions
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../install_guides/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Install Guides
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tasks
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tools/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tools
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../dependencies/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Dependencies
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../beats_tools/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Beats-Tools
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../beats_docs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Beats-Docs
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../misc/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Misc.
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../extras/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Extras
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="adding-kudos-to-the-application">Adding Kudos to the Application</h1>
<hr style="border: 2px solid black;">

<h2 id="how-to-add-kudos">How to Add Kudos</h2>
<p>There are two main ways to add kudos to the application:<br />
1. <strong>Simple kudos</strong> using a database query in kudos.yaml<br />
2. <strong>Complex kudos</strong> using a custom function in checks.py  </p>
<hr style="border: 1px solid black;">

<h2 id="method-1-adding-simple-kudos">Method 1: Adding Simple Kudos</h2>
<p>For simple kudos that can be determined using a straightforward database query or condition, you can add an entry directly in the kudos.yaml file. </p>
<h3 id="steps">Steps:</h3>
<ol>
<li><strong>Open</strong> the project/config/kudos.yaml file.   </li>
<li><strong>Add</strong> a new entry under the kudos section with a unique key for your kudo.   </li>
<li><strong>Fill in</strong> the required fields for the kudo.  </li>
</ol>
<h4 id="example">Example:</h4>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nt">kudos</span><span class="p">:</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="w">  </span><span class="nt">your_new_kudo_name</span><span class="p">:</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="w">    </span><span class="nt">include_in_check</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="w">    </span><span class="nt">beats</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">50</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="w">    </span><span class="nt">code</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="w">      </span><span class="no">if Activity.objects.filter(user=user, activity_type=&quot;ride&quot;).count() &gt;= 10:</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="w">        </span><span class="no">achieved = True</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="w">      </span><span class="no">else:</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="w">        </span><span class="no">achieved = False</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="w">    </span><span class="nt">kudos_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">badge</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="w">    </span><span class="nt">display_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">user</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Ten Rides Badge</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="w">    </span><span class="nt">icon_family</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">fa</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="w">    </span><span class="nt">icon_name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">fa-bicycle</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="w">    </span><span class="nt">style</span><span class="p">:</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="w">      </span><span class="nt">size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">3em</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="w">      </span><span class="nt">color</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ForestGreen</span>
</code></pre></div>
<h4 id="required-fields">Required Fields:</h4>
<ul>
<li>include_in_check: Set to true if this kudo should be checked for each activity.  You can set this to false for kudos that are only awarded under specific conditions (e.g. New User Kudos)</li>
<li>beats: The number of beats awarded for this kudo.   </li>
<li>code: A Python code snippet that sets the achieved variable to True or False.   </li>
<li>kudos_type: Can be "trophy", "badge", or "streak".    </li>
<li>display_type: Can be "user", "single", "multiple", or "streak".    </li>
<li>name: The display name of the kudo.   </li>
<li>icon_family: The icon family (e.g., "fa" for Font Awesome, "bi" for Bootstrap Icons).   </li>
<li>icon_name: The specific icon name.   </li>
<li>style: A dictionary containing size and color for the icon.   </li>
</ul>
<hr style="border: 1px solid black;">

<h2 id="method-2-adding-complex-kudos">Method 2: Adding Complex Kudos</h2>
<p>For more complex kudos that require advanced logic or multiple database queries, you'll need to create a custom function in <code>checks.py</code> and reference it in <code>kudos.yaml</code>.  </p>
<h3 id="steps_1">Steps:</h3>
<ol>
<li><strong>Open</strong> the project/apps/kudos/checks.py file.  </li>
<li><strong>Define</strong> a new function for your kudo check.  </li>
<li><strong>Open</strong> the project/config/kudos.yaml file.  </li>
<li><strong>Add</strong> a new entry referencing your custom function.  </li>
</ol>
<h4 id="examples">Examples:</h4>
<div class="highlight"><span class="filename">checks.py</span><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="k">def</span> <span class="nf">check_complex_kudo</span><span class="p">(</span><span class="n">user</span><span class="p">,</span> <span class="n">activity</span><span class="p">,</span> <span class="n">config</span><span class="p">):</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>    <span class="c1"># Your complex logic here</span>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>    <span class="c1"># ...</span>
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a>    <span class="k">if</span> <span class="n">complex_condition_met</span><span class="p">:</span>
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a>        <span class="k">return</span> <span class="kc">True</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;additional_info&quot;</span><span class="p">:</span> <span class="s2">&quot;Some details&quot;</span><span class="p">}</span>
<a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a>        <span class="k">return</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">None</span>
</code></pre></div>
<div class="highlight"><span class="filename">kudos.yaml</span><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="nt">kudos</span><span class="p">:</span>
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="w">  </span><span class="nt">complex_kudo_name</span><span class="p">:</span>
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="w">    </span><span class="nt">include_in_check</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a><span class="w">    </span><span class="nt">beats</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">75</span>
<a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a><span class="w">    </span><span class="nt">code</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;function:check_complex_kudo&quot;</span>
<a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a><span class="w">    </span><span class="nt">kudos_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">trophy</span>
<a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a><span class="w">    </span><span class="nt">display_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">single</span>
<a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a><span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Complex Achievement Trophy</span>
<a id="__codelineno-2-9" name="__codelineno-2-9" href="#__codelineno-2-9"></a><span class="w">    </span><span class="nt">icon_family</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bi</span>
<a id="__codelineno-2-10" name="__codelineno-2-10" href="#__codelineno-2-10"></a><span class="w">    </span><span class="nt">icon_name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bi-award</span>
<a id="__codelineno-2-11" name="__codelineno-2-11" href="#__codelineno-2-11"></a><span class="w">    </span><span class="nt">style</span><span class="p">:</span>
<a id="__codelineno-2-12" name="__codelineno-2-12" href="#__codelineno-2-12"></a><span class="w">      </span><span class="nt">size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">4em</span>
<a id="__codelineno-2-13" name="__codelineno-2-13" href="#__codelineno-2-13"></a><span class="w">      </span><span class="nt">color</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Purple</span>
</code></pre></div>
<h4 id="function-requirements">Function Requirements:</h4>
<ul>
<li>The function should take three parameters: user, activity, and config.  </li>
<li>It should return a tuple: (achieved, details).  <ul>
<li>achieved is a boolean indicating if the kudo was earned.   </li>
<li>details is either None or a dictionary with additional information.    </li>
</ul>
</li>
</ul>
<h4 id="how-it-works">How It Works:</h4>
<p>The check_for_kudos function in views.py processes each kudo defined in kudos.yaml:<br />
1. It loads the kudo configuration from kudos.yaml.  <br />
2. For each kudo, it checks if include_in_check is True.<br />
3. It then executes the code for the kudo:<br />
    - If the code is a Python snippet, it's executed directly.<br />
    - If the code starts with "function:", it calls the corresponding function in <code>checks.py</code>.<br />
4. If the kudo is achieved, it creates a new <code>Kudo</code> object and associates it with the user and activity. </p>
<hr style="border: 2px solid black;">

<h2 id="important-files-functions">Important Files / Functions</h2>
<hr style="border: 1px solid black;">

<h3 id="kudosyaml">Kudos.yaml</h3>
<ul>
<li>kudos.yaml contains the configuration for the kudos system.  It is used to define the kudos that can be awarded to users.</li>
<li>kudos.yaml is located @ <strong>project/config/kudos.yaml</strong></li>
<li>The location for this file is defined in <strong>settings.CONFIG_PATH</strong></li>
</ul>
<h4 id="examples_1">Examples:</h4>
<div class="highlight"><span class="filename">Generic Example with explanations</span><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="w"> </span><span class="nt">kudo_name</span><span class="p">:</span>
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="w">   </span><span class="nt">include_in_check</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true/false</span>
<a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a><span class="w">   </span><span class="nt">code</span><span class="p">:</span><span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">provide an if statement or function name to check if the kudo is</span>
<a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a><span class="w">          </span><span class="l l-Scalar l-Scalar-Plain">achieved if an if statement is provided, then the if statement will</span>
<a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a><span class="w">          </span><span class="l l-Scalar l-Scalar-Plain">be evaluated or if a function name is provided, then the function</span>
<a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a><span class="w">          </span><span class="l l-Scalar l-Scalar-Plain">will be called.</span>
<a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a><span class="w">   </span><span class="nt">kudos_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">trophy/badge/streak</span>
<a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a><span class="w">   </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Name of the kudo (as displayed within the app)</span>
<a id="__codelineno-3-9" name="__codelineno-3-9" href="#__codelineno-3-9"></a><span class="w">   </span><span class="nt">icon_family</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">fa/bi (Font Awesome, Bootstrap Icons, or others may be added</span>
<a id="__codelineno-3-10" name="__codelineno-3-10" href="#__codelineno-3-10"></a><span class="w">                </span><span class="l l-Scalar l-Scalar-Plain">in the future)</span>
<a id="__codelineno-3-11" name="__codelineno-3-11" href="#__codelineno-3-11"></a><span class="w">   </span><span class="nt">icon_name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Name of the icon to be used</span>
<a id="__codelineno-3-12" name="__codelineno-3-12" href="#__codelineno-3-12"></a><span class="w">   </span><span class="nt">style</span><span class="p">:</span><span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">dictionary containing the style of the icon</span>
<a id="__codelineno-3-13" name="__codelineno-3-13" href="#__codelineno-3-13"></a><span class="w">     </span><span class="l l-Scalar l-Scalar-Plain">size</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">size of the icon</span>
<a id="__codelineno-3-14" name="__codelineno-3-14" href="#__codelineno-3-14"></a><span class="w">     </span><span class="l l-Scalar l-Scalar-Plain">color</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">color of the icon</span>
</code></pre></div>
<p><div class="highlight"><span class="filename">Example of kudo with if/then statement</span><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="nt">metric_century_trophy</span><span class="p">:</span>
<a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="w">  </span><span class="nt">include_in_check</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a><span class="w">  </span><span class="nt">code</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a><span class="w">    </span><span class="no">if activity.core_data[&quot;distance&quot;] &gt;= 100:</span>
<a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a><span class="w">      </span><span class="no">achieved = True</span>
<a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a><span class="w">    </span><span class="no">else:</span>
<a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a><span class="w">      </span><span class="no">achieved = False</span>
<a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a><span class="w">  </span><span class="nt">kudos_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">trophy</span>
<a id="__codelineno-4-9" name="__codelineno-4-9" href="#__codelineno-4-9"></a><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Metric Century Trophy</span>
<a id="__codelineno-4-10" name="__codelineno-4-10" href="#__codelineno-4-10"></a><span class="w">  </span><span class="nt">icon_family</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">fa</span>
<a id="__codelineno-4-11" name="__codelineno-4-11" href="#__codelineno-4-11"></a><span class="w">  </span><span class="nt">icon_name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">fa-star</span>
<a id="__codelineno-4-12" name="__codelineno-4-12" href="#__codelineno-4-12"></a><span class="w">  </span><span class="nt">style</span><span class="p">:</span>
<a id="__codelineno-4-13" name="__codelineno-4-13" href="#__codelineno-4-13"></a><span class="w">    </span><span class="nt">size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">3em</span>
<a id="__codelineno-4-14" name="__codelineno-4-14" href="#__codelineno-4-14"></a><span class="w">    </span><span class="nt">color</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">MidnightBlue</span>
</code></pre></div>
<div class="highlight"><span class="filename">Example of kudo with function</span><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="nt">two_hundred_km_in_a_week_trophy</span><span class="p">:</span>
<a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="w">  </span><span class="nt">include_in_check</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a><span class="w">  </span><span class="nt">code</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;function:check_two_hundred_km_in_a_week&quot;</span>
<a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a><span class="w">  </span><span class="nt">kudos_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">trophy</span>
<a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">200 km in a week</span>
<a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a><span class="w">  </span><span class="nt">icon_family</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bi</span>
<a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a><span class="w">  </span><span class="nt">icon_name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bi-patch-check-fill</span>
<a id="__codelineno-5-8" name="__codelineno-5-8" href="#__codelineno-5-8"></a><span class="w">  </span><span class="nt">style</span><span class="p">:</span>
<a id="__codelineno-5-9" name="__codelineno-5-9" href="#__codelineno-5-9"></a><span class="w">    </span><span class="nt">size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">3em</span>
<a id="__codelineno-5-10" name="__codelineno-5-10" href="#__codelineno-5-10"></a><span class="w">    </span><span class="nt">color</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Gold</span>
</code></pre></div></p>
<hr style="border: 1px solid black;">

<h3 id="check_for_kudos">check_for_kudos()</h3>
<p>The check_for_kudos function is located in the project/apps/kudos/views.py file. This function serves as the main entry point for evaluating and awarding kudos to users based on their activities.</p>
<h4 id="purpose">Purpose:</h4>
<p>The primary purpose of check_for_kudos is to determine whether a user has earned any kudos for a given activity. It acts as a bridge between the activity data and the kudo definitions, applying the criteria specified in the kudos.yaml configuration file to decide if a kudo should be awarded.</p>
<h4 id="functionality">Functionality:</h4>
<ul>
<li>Reads the kudo configuration from the kudos.yaml file.</li>
<li>Iterates through each kudo definition in the configuration.</li>
<li>Evaluates whether the given activity meets the criteria for each kudo.</li>
<li>Awards kudos to the user when criteria are met.</li>
<li>Handles both simple (inline code) and complex (function-based) kudo checks.</li>
</ul>
<h4 id="how-its-called">How It's Called:</h4>
<p>This function is typically called after a new activity is created or updated. It would be invoked in views or background tasks that process user activities.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="c1"># After creating or updating an activity</span>
<a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a><span class="n">check_for_kudos</span><span class="p">(</span><span class="n">user</span><span class="p">,</span> <span class="n">activity</span><span class="p">)</span>
</code></pre></div>
<h4 id="key-features">Key Features:</h4>
<ul>
<li>Supports excluding specific kudos from being checked (useful for combined activities).</li>
<li>Dynamically imports and executes complex check functions from project.apps.kudos.checks.</li>
<li>Logs various stages of the kudo checking process for debugging and monitoring.</li>
<li>Handles both inline code and function-based kudo criteria.</li>
</ul>
<h4 id="parameters">Parameters:</h4>
<ul>
<li><em>user</em>: The user for whom kudos are being checked.</li>
<li><em>activity</em>: The activity being evaluated for kudos.</li>
<li><em>excluded_kudos</em>: An optional list of kudo names to exclude from checking.</li>
</ul>
<h4 id="integration">Integration:</h4>
<p>This function integrates closely with:<br />
- The <strong>kudos.yaml</strong> configuration file.<br />
- The <strong>checks.py</strong> module for complex kudo evaluations.<br />
- The logging system for tracking the kudo checking process.  </p>
<p>By centralizing the kudo checking logic in this function, the application maintains a consistent approach to awarding kudos across different types of activities and achievements.</p>
<hr style="border: 1px solid black;">

<h3 id="checkspy">checks.py</h3>
<p>The checks.py file is located in the project/apps/kudos/ directory. This file contains the logic for evaluating complex kudos that require more sophisticated checks than simple database queries.</p>
<h4 id="purpose-and-functionality">Purpose and Functionality:</h4>
<ul>
<li>Houses functions that determine whether a user has earned specific kudos based on their activities.</li>
<li>Each function in this file corresponds to a complex kudo check defined in the kudos.yaml configuration.</li>
<li>These functions analyze user activities, streaks, and other relevant data to decide if a kudo should be awarded.</li>
</ul>
<h4 id="structure-and-design">Structure and Design:</h4>
<ul>
<li>Contains main check functions for different types of kudos (e.g., streaks, distance milestones).</li>
<li>Includes helper functions to support the main checks, handling common tasks like age calculation or streak management.</li>
<li>Utilizes Django models, particularly Activity and Kudo, to interact with the database.</li>
</ul>
<h4 id="integration-with-the-kudos-system">Integration with the Kudos System:</h4>
<ul>
<li>Functions in this file are called by the check_for_kudos function in views.py.</li>
<li>They are referenced in the kudos.yaml file using the function: prefix in the code field of kudo definitions.</li>
</ul>
<h4 id="function-signature-and-return-values">Function Signature and Return Values:</h4>
<ul>
<li>Most functions follow a standard signature: def check_function_name(user, activity, config):</li>
<li>They typically return a tuple: (achieved, details), where achieved is a boolean and details is a dictionary or None.</li>
</ul>
<h4 id="key-features_1">Key Features:</h4>
<ul>
<li>Implements complex logic for kudos that can't be determined by simple database queries.</li>
<li>Handles time-based calculations, often using the pendulum library for advanced date and time operations.</li>
<li>Includes logging for tracking important events and potential issues.</li>
<li>Manages edge cases and ensures data integrity (e.g., preventing duplicate kudos).</li>
</ul>
<h4 id="extensibility">Extensibility:</h4>
<ul>
<li>New complex kudo checks can be added to this file, following the established patterns and conventions.</li>
<li>Developers can create custom logic for new types of achievements or milestones.</li>
<li>By centralizing complex kudo checks in checks.py, the application maintains a clean separation of concerns and allows for easy addition and modification of kudos logic.</li>
</ul>
<hr style="border: 1px solid black;">

<h3 id="get_kudos_config">get_kudos_config()</h3>
<p>The <code>get_kudos_config()</code> function is a crucial utility that retrieves the kudos configuration for the project from a YAML file.</p>
<h4 id="purpose_1">Purpose</h4>
<ul>
<li>Loads and returns the kudos configuration from <code>kudos.yaml</code></li>
<li>Centralizes configuration access for consistency across the project</li>
</ul>
<h4 id="location">Location</h4>
<ul>
<li>File: <code>project/apps/common/utils/config.py</code></li>
<li>Module: <code>project.apps.common.utils.config</code></li>
</ul>
<h4 id="usage">Usage</h4>
<ul>
<li>Primary caller: <code>check_for_kudos()</code> function in <code>project/apps/kudos/views.py</code></li>
<li>Used in kudos-related operations throughout the project</li>
</ul>
<h4 id="functionality_1">Functionality</h4>
<ol>
<li>Constructs the path to <code>kudos.yaml</code> using <code>settings.CONFIG_PATH</code></li>
<li>Opens and reads the YAML file</li>
<li>Loads the YAML content into a Python dictionary</li>
<li>Extracts and returns the 'kudos' section as <code>dict_items</code></li>
</ol>
<h4 id="returns">Returns</h4>
<ul>
<li><code>dict_items</code>: Key-value pairs of kudos configurations</li>
</ul>
<p>The <code>get_kudos_config()</code> function ensures that all parts of the project have access to the latest kudos configuration, facilitating consistent kudos checking and awarding processes.</p>
<hr style="border: 1px solid black;">












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      &copy; 2024 <a href="https://justtim.com"  target="_blank" rel="noopener">justtim.com</a>
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/timpandrews" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 480 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1M480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2m-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3m-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs", "navigation.sections", "toc.integrate", "navigation.top", "search.suggest", "search.highlight", "content.tabs.link", "content.code.annotation", "content.code.copy"], "search": "../../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.83f73b43.min.js"></script>
      
    
  </body>
</html>